these codes are still awfully ineficient and with too much hardcode to be documented
